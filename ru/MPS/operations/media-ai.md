# Интеграция Media AI

Media Processing Service платформы Freedom Cloud Native предоставляет расширенные AI-возможности, которые автоматизируют транскрибацию, извлечение хайлайтов, суммаризацию и отслеживание областей интереса (ROI, Region of Interest). В этом руководстве рассматриваются методы интеграции умных субтитров, интеллектуальных хайлайтов, LLM-суммаризации и интеллектуального распознавания ROI.

## Предварительные требования

- Активируйте Media Processing Service и убедитесь, что у вашей учётной записи есть доступ к COS.
- Для функций live-стриминга активируйте StreamLive и авторизуйте MPS для доступа к данным StreamLive.
- Создайте или выберите AI-шаблоны в консоли либо зафиксируйте их ID для использования через API.

## Умные субтитры и титры

### Обзор

Умные субтитры преобразуют устную речь в текст с помощью автоматического распознавания речи (ASR) и при необходимости переводят её на другие языки. Система поддерживает сотни языков и позволяет встраивать субтитры непосредственно в видео или выводить их в виде отдельных файлов. Стили субтитров (шрифт, размер, цвет, фон и позиция) полностью настраиваются.

### Ключевые преимущества

- **Широкая поддержка платформ:** Работает с VOD-файлами, live-стримами и интерактивными RTC-потоками. Live-субтитры поддерживают стабильный и градиентный режимы без изменений на стороне плеера.
- **Высокая точность:** Используются крупные модели и поддерживаются словари hotword и терминологии.
- **Богатая языковая поддержка:** Распознаёт смешанную речь (например, китайский и английский) и поддерживает различные диалекты.
- **Гибкая настройка стилей:** Настройка шрифта, цвета, позиции и фона.

### Создание задач

1. **Консоль:** В консоли MPS нажмите **Create VOD Processing Task**. Выберите входной файл, добавьте узел Smart Subtitle в workflow, выберите предустановленный или пользовательский шаблон, задайте выходное хранилище и создайте задачу.
2. **API:** Вызовите `ProcessMedia`, указав `SmartSubtitlesTask.Definition` равным ID шаблона. Задайте `InputInfo`, `OutputStorage`, `OutputDir` и (опционально) `TaskNotifyConfig` для callback-уведомлений.
3. **Автоматический триггер:** Создайте on-demand оркестрацию с узлом Smart Subtitle, укажите триггерный бакет и директорию и включите её. Новые загрузки будут автоматически запускать задачи субтитров.

## Интеллектуальные хайлайты

### Обзор

Интеллектуальные хайлайты автоматически извлекают наиболее интересные сегменты видео (например, голы в спорте или драматические моменты в фильмах), используя AI-модели, которые сопоставляют визуальные и текстовые признаки. Хайлайты улучшают пользовательский опыт и идеально подходят для превью и публикаций в соцсетях.

### Создание задач

1. **Консоль:** Создайте задачу обработки или расписание, добавьте узел AI Analysis и выберите предустановленный шаблон Intelligent Highlights.
2. **API:** Вызовите `ProcessMedia`, указав `AiAnalysisTask.Definition` равным ID предустановленного шаблона (часто 26). Используйте `ExtendedParameter` для тонкой настройки: количество клипов (`top_clip`), категории (`force_cls`), детекцию голосовой активности (`need_vad`), порог схожести и поведение объединения клипов.
3. **Callback-уведомления и запросы:** Настройте `TaskNotifyConfig` для уведомлений о результатах или опрашивайте `DescribeTaskDetail` по ID задачи.

## LLM-суммаризация

### Обзор

LLM-суммаризация использует большие языковые модели для краткого изложения видеоконтента. Видео сегментируется на логические блоки, после чего формируется компактное текстовое резюме. Подходит для образовательных курсов, новостных дайджестов и извлечения знаний.

### Создание задач

1. **Консоль (через schedule):** Создайте оркестрацию с узлом AI Analysis и выберите предустановленный шаблон LLM Summarize.
2. **API:** Вызовите `ProcessMedia`, указав `AiAnalysisTask.Definition` равным ID шаблона LLM-суммаризации (обычно 22). В `ExtendedParameter` доступны настройки:
   - `split.method`: метод сегментации (llm или nlp);
   - `split.model`: выбор модели (например, Hunyuan, DeepSeek-V3);
   - `need_ocr`: включение OCR для учёта текста на экране;
   - `text_requirement`: ограничения по длине или содержанию резюме;
   - `dstlang`: язык итогового резюме.
3. **Выходные данные и уведомления:** Укажите `OutputStorage` и `OutputDir` для файлов результатов; настройте callback-уведомления или проверяйте статус через `DescribeTaskDetail`.

## Интеллектуальное распознавание ROI

### Обзор

Распознавание области интереса (ROI) в реальном времени определяет важные визуальные элементы — лица, игровых персонажей или ведущих. Эти данные могут передаваться на устройство воспроизведения, позволяя:

- автоматически размывать фон, фокусируясь на главном объекте;
- предотвращать перекрытие ключевых элементов экранными комментариями;
- корректно выполнять преобразование горизонтального видео в вертикальное, центрируя важные области.

### Интеграция

ROI-распознавание обычно используется в составе других задач (например, вертикальной трансформации или интеллектуального кадрирования). Для включения:

1. Создайте шаблон с активированным ROI-детектированием (часто доступно в настройках horizontal-to-vertical transformation).
2. Запустите задачи через консоль или API с включённым ROI. При использовании API укажите соответствующие параметры в `AiAnalysisTask` или специализированном API кадрирования.
3. Выходные данные содержат координаты ROI для каждого кадра.

## Best practices

- **Комбинируйте функции осознанно:** Например, генерируйте субтитры и резюме в одном пайплайне для повышения доступности и понимания контента.
- **Тонко настраивайте параметры:** Расширенные параметры позволяют управлять длиной клипов, моделями сегментации и порогами; подбирайте значения под ваш контент.
- **Автоматизируйте workflow:** Сохраняйте шаблоны оркестраций и включайте триггеры, чтобы новые загрузки автоматически запускали генерацию субтитров, хайлайтов и резюме.
- **Контролируйте затраты:** AI-задачи тарифицируются отдельно от стандартного транскодирования. Подбирайте количество клипов, длину резюме и языки, чтобы сбалансировать качество и стоимость.

Интеграция функций Media AI в ваши процессы позволяет масштабно улучшить обнаружение контента, доступность и вовлечённость пользователей.
